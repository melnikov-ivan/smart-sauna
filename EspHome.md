EspHome
=======

Многие сценарии ложатся на одинаковую схему
- прочитать показания датчика
- передать значение через mqtt и webserver

EspHome позволяет сделать это через конфигурацию.

Запуск
------

- `esphome sauna.yaml run` - загрузка конфигурации на ноду
- `esphome . dashboard` - online editor http://localhost:6052/

## Датчики


### Dallas

Все датчики цепляются к одной ноге `GPIO18` по протоколу OneWire.
При старте показывает найденные адреса 
```
[11:29:37][C][dallas.sensor:072]: DallasComponent:
[11:29:37][C][dallas.sensor:073]:   Pin: GPIO18 (Mode: INPUT)
[11:29:37][C][dallas.sensor:074]:   Update Interval: 60.0s
[11:29:37][D][dallas.sensor:079]:   Found sensors:
[11:29:37][D][dallas.sensor:082]:     0xEF800000263C0828
```
Прописываем в сенсоре.

### Уровень воды
Датчик выдает напряжение пропорцинально давлению. Подключаем к пинам с поддержкой АЦП (ADC). На esp32 это с 32 по 39.
Калибруем прямо в настройках сенсораы.

## Прошивка Mijia
Надо перепрошить датчик согласно инструкции. Проставить нужные интервал обновления.
https://atc1441.github.io/TelinkFlasher.html
